<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="ru"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="UTF-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ 3D-Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ¸ Ğ¿Ğ¾ STL&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;!-- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞº --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r148/three.min.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script src="https://cdn.jsdelivr.net/npm/three@0.148.0/examples/js/loaders/STLLoader.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script src="https://cdn.jsdelivr.net/npm/three@0.148.0/examples/js/utils/BufferGeometryUtils.js"&gt;&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>body {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-family: Arial, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #f5f5f5;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>h1, h2 {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>input, select, button {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>max-width: 400px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-sizing: border-box;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.viewer {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>max-width: 600px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>height: 400px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #eee;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>#result {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 18px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #222;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;h1&gt;ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ 3D-Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ¸&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;input type="file" id="stlFile" accept=".stl" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div id="fileName"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;label for="material"&gt;ĞœĞ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;select id="material"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;option value="20"&gt;PLA / PETG â€” 20 â‚½/Ğ³&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;option value="25"&gt;ABS â€” 25 â‚½/Ğ³&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;option value="30"&gt;TPU â€” 30 â‚½/Ğ³&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;option value="40"&gt;ĞĞµĞ¹Ğ»Ğ¾Ğ½ â€” 40 â‚½/Ğ³&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/select&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;button onclick="calculate()"&gt;Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div id="result"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;h2&gt;3D-Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div id="viewer" class="viewer"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const viewer = document.getElementById("viewer");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const scene = new THREE.Scene();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const camera = new THREE.PerspectiveCamera(75, viewer.clientWidth / viewer.clientHeight, 0.1, 1000);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const renderer = new THREE.WebGLRenderer({ antialias: true });</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>renderer.setSize(viewer.clientWidth, viewer.clientHeight);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>viewer.appendChild(renderer.domElement);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>camera.position.z = 100;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const light = new THREE.DirectionalLight(0xffffff, 1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>light.position.set(0, 0, 100).normalize();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>scene.add(light);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let stlMesh, geometry;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById("stlFile").addEventListener("change", function (e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const file = e.target.files[0];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (!file || !file.name.endsWith('.stl')) return;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById("fileName").textContent = `Ğ¤Ğ°Ğ¹Ğ»: ${file.name}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>reader.onload = function (event) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const loader = new THREE.STLLoader();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>geometry = loader.parse(event.target.result);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (stlMesh) scene.remove(stlMesh);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const material = new THREE.MeshLambertMaterial({ color: 0xff5533 });</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>stlMesh = new THREE.Mesh(geometry, material);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>geometry.computeBoundingBox();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const size = geometry.boundingBox.getSize(new THREE.Vector3());</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const maxDim = Math.max(size.x, size.y, size.z);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>stlMesh.scale.set(50 / maxDim, 50 / maxDim, 50 / maxDim);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>stlMesh.rotation.x = -Math.PI / 2;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>scene.add(stlMesh);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>animate();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>reader.readAsArrayBuffer(file);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function animate() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>requestAnimationFrame(animate);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (stlMesh) stlMesh.rotation.z += 0.01;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>renderer.render(scene, camera);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function calculate() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (!geometry) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById("result").textContent = "Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ STL-Ñ„Ğ°Ğ¹Ğ».";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const materialPrice = parseFloat(document.getElementById("material").value);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const density = 1.3; // Ğ³/ÑĞ¼Â³</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const volume_mm3 = computeVolume(geometry); // Ğ¼Ğ¼Â³</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const volume_cm3 = volume_mm3 / 1000; <span class="Apple-converted-space">Â  Â  Â  </span>// ÑĞ¼Â³</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const weight = volume_cm3 * density;<span class="Apple-converted-space">Â  Â  Â  Â  </span>// Ğ³</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const cost = Math.max(weight * materialPrice, 300); // Ğ¼Ğ¸Ğ½. 300 â‚½</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById("result").innerHTML =</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`ğŸ“ ĞĞ±ÑŠÑ‘Ğ¼: ${volume_cm3.toFixed(2)} ÑĞ¼Â³&lt;br&gt;` +</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`âš–ï¸ Ğ’ĞµÑ: ${weight.toFixed(1)} Ğ³&lt;br&gt;` +</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`ğŸ’° Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ: ${cost.toFixed(0)} â‚½`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function computeVolume(geometry) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>let totalVolume = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const pos = geometry.attributes.position;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>for (let i = 0; i &lt; pos.count; i += 3) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const ax = pos.getX(i), ay = pos.getY(i), az = pos.getZ(i);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const bx = pos.getX(i + 1), by = pos.getY(i + 1), bz = pos.getZ(i + 1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const cx = pos.getX(i + 2), cy = pos.getY(i + 2), cz = pos.getZ(i + 2);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const v321 = cx * by * az;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const v231 = bx * cy * az;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const v312 = cx * ay * bz;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const v132 = ax * cy * bz;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const v213 = bx * ay * cz;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const v123 = ax * by * cz;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>totalVolume += (-v321 + v231 + v312 - v132 - v213 + v123);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return Math.abs(totalVolume / 6.0);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
